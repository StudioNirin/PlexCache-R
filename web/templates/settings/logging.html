{% extends "settings/index.html" %}

{% block settings_content %}
<div class="card">
    <div class="card-header">
        <i data-lucide="file-text"></i>
        <h2>Logging Settings</h2>
    </div>
    <div class="card-body">
        <form hx-put="/settings/logging" hx-target="#settings-alert-container" hx-swap="innerHTML">

            <h3 style="font-size: 1rem; color: var(--plex-orange); margin-bottom: 1rem;">
                <i data-lucide="archive" style="width: 18px; height: 18px; vertical-align: middle;"></i>
                Log Retention
            </h3>

            <div class="grid grid-2">
                <div class="form-group">
                    <label for="max_log_files">Maximum Log Files</label>
                    <input type="number" id="max_log_files" name="max_log_files"
                           class="input-narrow"
                           value="{{ settings.max_log_files | default(24) }}" min="1" max="100">
                    <div class="form-hint">Number of log files to keep (1 file created per run)</div>
                </div>

                <div class="form-group">
                    <label for="keep_error_logs_days">Error Log Retention (days)</label>
                    <input type="number" id="keep_error_logs_days" name="keep_error_logs_days"
                           class="input-narrow"
                           value="{{ settings.keep_error_logs_days | default(7) }}" min="0" max="365">
                    <div class="form-hint">Days to keep logs containing warnings/errors (0 = disabled)</div>
                </div>
            </div>

            <div class="form-hint" style="margin-top: 1rem; padding: 1rem; background: var(--plex-surface); border-radius: 6px;">
                <strong>How it works:</strong>
                <ul style="margin: 0.5rem 0 0 1.5rem; padding: 0;">
                    <li><strong>Max Log Files:</strong> PlexCache creates a new log file each run. Older logs are automatically deleted when this limit is reached.</li>
                    <li><strong>Error Log Retention:</strong> Logs containing WARNING or ERROR messages are preserved in <code>logs/errors/</code> for longer-term debugging.</li>
                </ul>
            </div>

            <h3 style="font-size: 1rem; color: var(--plex-orange); margin-top: 2rem; margin-bottom: 1rem;">
                <i data-lucide="clock" style="width: 18px; height: 18px; vertical-align: middle;"></i>
                Time Display
            </h3>

            <div class="form-group">
                <label for="time_format">Time Format</label>
                <select id="time_format" name="time_format">
                    <option value="24h" {% if settings.time_format == '24h' %}selected{% endif %}>24-hour (14:30:00)</option>
                    <option value="12h" {% if settings.time_format == '12h' %}selected{% endif %}>12-hour (2:30:00 PM)</option>
                </select>
                <div class="form-hint">Controls how timestamps are displayed throughout the Web UI (dashboard, logs, schedule)</div>
            </div>

            <h3 style="font-size: 1rem; color: var(--plex-orange); margin-top: 2rem; margin-bottom: 1rem;">
                <i data-lucide="activity" style="width: 18px; height: 18px; vertical-align: middle;"></i>
                Dashboard
            </h3>

            <div class="form-group">
                <label for="activity_retention_hours">Recent Activity Retention (hours)</label>
                <select id="activity_retention_hours" name="activity_retention_hours">
                    <option value="12" {% if settings.activity_retention_hours == 12 %}selected{% endif %}>12 hours</option>
                    <option value="24" {% if settings.activity_retention_hours == 24 or not settings.activity_retention_hours %}selected{% endif %}>24 hours (default)</option>
                    <option value="48" {% if settings.activity_retention_hours == 48 %}selected{% endif %}>48 hours</option>
                    <option value="72" {% if settings.activity_retention_hours == 72 %}selected{% endif %}>3 days</option>
                    <option value="168" {% if settings.activity_retention_hours == 168 %}selected{% endif %}>7 days</option>
                </select>
                <div class="form-hint">How long to keep Recent Activity entries on the Dashboard</div>
            </div>

            <div class="form-group mb-0" style="margin-top: 1.5rem;">
                <button type="submit" class="btn btn-primary">
                    <i data-lucide="save"></i>
                    Save Logging Settings
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
