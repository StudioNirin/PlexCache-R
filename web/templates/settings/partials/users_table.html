{% if users %}
<div class="user-list user-list-scrollable">
    <div class="user-list-header">
        <span class="user-col">User</span>
        <span class="toggle-col">OnDeck</span>
        <span class="toggle-col">Watchlist</span>
    </div>
    <div class="user-list-body">
        {% for user in users %}
        <div class="user-row {% if user.is_admin %}user-admin{% endif %}">
            <span class="user-col">
                <span class="user-name">{{ user.title }}</span>
                {% if user.is_admin %}
                    <span class="badge badge-muted">Admin</span>
                {% elif user.is_local %}
                    <span class="badge badge-info">Local</span>
                {% else %}
                    <span class="badge badge-warning">Remote</span>
                {% endif %}
            </span>
            <span class="toggle-col">
                <label class="toggle-switch">
                    <input type="checkbox" name="include_ondeck_{{ user.title }}" value="on"
                           {% if not user.skip_ondeck %}checked{% endif %}
                           {% if user.is_admin %}disabled checked{% endif %}>
                    <span class="toggle-slider"></span>
                </label>
            </span>
            <span class="toggle-col">
                <label class="toggle-switch" {% if not user.is_local %}title="Remote users use RSS feed"{% endif %}>
                    <input type="checkbox" name="include_watchlist_{{ user.title }}" value="on"
                           {% if not user.skip_watchlist %}checked{% endif %}
                           {% if user.is_admin %}disabled checked{% endif %}>
                    <span class="toggle-slider"></span>
                </label>
                {% if not user.is_local %}<span class="text-muted" style="font-size: 0.7rem; margin-left: 4px;">RSS</span>{% endif %}
            </span>
        </div>
        {% endfor %}
    </div>
</div>
<div class="form-hint mt-1">Toggle OFF to exclude a user's data from caching. Remote users marked "RSS" use the RSS feed for Watchlist.</div>
{% else %}
<div class="no-libraries">
    <i data-lucide="users"></i>
    {% if plex_error %}
        <span>{{ plex_error }}</span>
    {% else %}
        <span>No users configured. Click "Sync Users" to fetch users from Plex.</span>
    {% endif %}
</div>
{% endif %}
<script>lucide.createIcons();</script>
